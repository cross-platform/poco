{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build",
            "type": "shell",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "windows": {
                "command": [
                    "cd openssl;",
                    "meson setup builddir --buildtype=release -Dmt=disabled;",
                    "meson compile -C builddir;",
                    "cd ..;",
                    "mkdir -force builddir;",
                    "cd builddir;",
                    "cp -r -force ../openssl/subprojects/openssl-3.0.2/generated-config/archs/VC-WIN64A/no-asm/include ../openssl/subprojects/openssl-3.0.2;",
                    "cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=bundle -DENABLE_CRYPTO=ON -DBUILD_SHARED_LIBS=OFF -DPOCO_MT=OFF -DCMAKE_CXX_FLAGS=\"-DPOCO_NO_AUTOMATIC_LIBS -DPOCO_STATIC\";",
                    "cmake --build . --config Release;",
                    "cmake --build . --target install;",
                    "python3 ../scripts/bundle.py win release_md done"
                ],
                "problemMatcher": {
                    "base": "$msCompile",
                    "fileLocation": [
                        "relative",
                        "${workspaceFolder}/builddir"
                    ]
                }
            },
            "osx": {
                "command": [
                    "bash openssl/build-universal.sh &&",
                    "mkdir -p builddir &&",
                    "cd builddir &&",
                    "cp -r ../openssl/subprojects/openssl-3.0.2/generated-config/archs/darwin64-arm64-cc/asm/include ../openssl/subprojects/openssl-3.0.2 &&",
                    "cp -r ../openssl/subprojects/openssl-3.0.2/generated-config/archs/darwin64-x86_64-cc/asm/include ../openssl/subprojects/openssl-3.0.2 &&",
                    "cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=bundle -DENABLE_CRYPTO=ON -DBUILD_SHARED_LIBS=OFF -DCMAKE_OSX_DEPLOYMENT_TARGET=10.15 -DCMAKE_OSX_ARCHITECTURES=\"arm64;x86_64\" &&",
                    "cmake --build . --config Release -- -j8 &&",
                    "cmake --build . --target install &&",
                    "python3 ../scripts/bundle.py mac release done"
                ],
                "problemMatcher": {
                    "base": "$gcc",
                    "fileLocation": [
                        "relative",
                        "${workspaceFolder}/builddir/"
                    ]
                }
            }
        }
    ]
}
